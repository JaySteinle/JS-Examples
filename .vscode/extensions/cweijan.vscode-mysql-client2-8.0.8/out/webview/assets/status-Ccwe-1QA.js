import{a as Q,r as S,Z as A,f as c,g as e,F as B,B as D,P as F,Q as j,o,t as V,C as z,N as U,v as l,K as E,j as d,J as L,h as u,I as x,k as b,G as I,e as T,n as g,a9 as w,ab as k}from"./app-CsfJRy1X.js";import{L as q,a as H,b as N}from"./lineChartData-D8T5pDz7.js";import{A as G}from"./arrayUtil-CzswX_vs.js";import{E as K,a as O}from"./index-IXPW6-XP.js";import"./objectUtil-Z6JRxuBJ.js";import"./viewUtil-DCbZMcCo.js";import"./constants-DgoLmzql.js";import"./index-Mol43tTP.js";import"./_baseIteratee-B1xu3wc6.js";import"./isEqual-D5tWelSt.js";import"./merge-XvLx2pLN.js";import"./_initCloneObject-C9-7aIdS.js";import"./isArrayLikeObject-TyuahpZ8.js";import"./index-CFkyrkQx.js";const J=m=>(F("data-v-f9336731"),m=m(),j(),m),W={class:"pl-4"},X=J(()=>e("div",{class:"mb-2"}," Server Infos: ",-1)),Z={class:"flex flex-col gap-y-1"},R={class:"var-name"},Y={class:"select-all"},tt=Q({__name:"MySQLBasic",props:{variableList:{}},setup(m){const s=m,t=S({}),h=[{name:"Port",value:"report_port"},{name:"Version",value:"version"},{name:"Slow Query Log",value:"slow_query_log"},{name:"Performance Schema",value:"performance_schema"},{name:"Base Directory",value:"basedir"},{name:"Data Directory",value:"datadir"}];A(()=>{t.value=G.arrayToObj(s.variableList.rows,a=>a.Variable_name,"Value")});const f=a=>t.value[a];return(a,v)=>(o(),c("div",W,[X,e("div",Z,[(o(),c(B,null,D(h,_=>e("div",{key:_.name,class:"flex gap-x-2 flex-wrap shrink-0"},[e("div",R,V(_.name)+":",1),e("div",Y,V(f(_.value)),1)])),64))])]))}}),et=z(tt,[["__scopeId","data-v-f9336731"]]),st={class:"pl-2 my-1"},at={class:"text-center"},it=Q({__name:"Process",setup(m){const s=S(0),t=S({fields:[],rows:[],supportKill:!1});function h(a){return a.match(/SQL|INFO|SQL_TEXT/i)?null:a==="Host"?150:100}function f(a){l.emit("killProcess",a)}return U(()=>{l.on("processList",v=>{t.value=v}),l.emit("processList");const a=()=>{s.value=window.innerHeight-110};a(),window.addEventListener("resize",a)}),(a,v)=>{const _=E("vsc-button"),C=E("vsc-tooltip"),n=K,y=O;return o(),c("div",null,[e("div",st,[d(C,{title:a.$t("common.refresh")},{default:L(()=>[d(_,{type:"icon",icon:"codicon-refresh text-base",onClick:v[0]||(v[0]=i=>u(l).emit("processList"))})]),_:1},8,["title"])]),d(y,{data:t.value.rows,height:s.value,border:""},{default:L(()=>[(o(!0),c(B,null,D(t.value.fields,(i,r)=>(o(),x(n,{key:r,prop:i.name,label:i.name,align:"center",width:h(i.name)},null,8,["prop","label","width"]))),128)),t.value.supportKill?(o(),x(n,{key:0,label:"Action",align:"center",width:"70"},{default:L(({row:i})=>[e("div",at,[d(_,{type:"icon",icon:"codicon-debug-stop",class:"red",title:"Kill",onClick:r=>f(i)},null,8,["onClick"])])]),_:1})):b("",!0)]),_:1},8,["data","height"])])}}}),ot={class:"status-container"},lt={class:"tab"},nt={class:"flex flex-row",style:{height:"45vh","margin-top":"10px"}},rt={class:"basis-1/3"},ct={class:"basis-2/3"},ut=e("span",{class:"select-none"},"Traffic:",-1),dt={style:{height:"300px"}},pt={class:"flex"},vt={class:"basis-full"},_t=e("span",{class:"select-none"},"Queries:",-1),mt={style:{height:"300px"}},Tt=Q({__name:"status",setup(m){const s=S("processList"),t=I({info:{dbType:null},process:{fields:[],rows:[]},variableList:{fields:[],rows:[]},statusList:{fields:[],rows:[]}}),h=new q,f=new q;function a(){n.dashBoard&&l.emit("dashBoard")}function v(){return window.innerHeight-80}const _=h.toChartData(),C=f.toChartData(),n=I({processList:!0,dashBoard:T(()=>["MariaDB","MySQL"].includes(t.info.dbType)),variableList:T(()=>["MariaDB","MySQL","PostgreSQL"].includes(t.info.dbType)),statusList:T(()=>["MariaDB","MySQL","PostgreSQL"].includes(t.info.dbType))});function y(){a(),l.emit("processList"),n.variableList&&l.emit("variableList"),n.statusList&&l.emit("statusList")}return l.on("info",i=>{t.info=i,n[s.value]||(s.value="processList"),y()}).on("variableList",i=>{t.variableList=i}).on("statusList",i=>{t.statusList=i}).on("dashBoard",i=>{f.addData(i.traffic),h.addData(i.queries)}).init("status"),window.addEventListener("focus",()=>{l.init("status")}),y(),setTimeout(()=>a(),1e3),setInterval(()=>a(),3e3),(i,r)=>{const M=K,P=O;return o(),c("div",ot,[e("ul",lt,[n.dashBoard?(o(),c("li",{key:0,class:g(["tab__item",{"tab__item--active":s.value=="dashBoard"}]),onClick:r[0]||(r[0]=p=>{s.value="dashBoard",a()})}," Dashboard ",2)):b("",!0),n.processList?(o(),c("li",{key:1,class:g(["tab__item",{"tab__item--active":s.value=="processList"}]),onClick:r[1]||(r[1]=p=>{s.value="processList",u(l).emit("processList")})}," ProcessList ",2)):b("",!0),n.variableList?(o(),c("li",{key:2,class:g(["tab__item",{"tab__item--active":s.value=="variableList"}]),onClick:r[2]||(r[2]=p=>{s.value="variableList",u(l).emit("variableList")})}," VariableList ",2)):b("",!0),n.statusList?(o(),c("li",{key:3,class:g(["tab__item",{"tab__item--active":s.value=="statusList"}]),onClick:r[3]||(r[3]=p=>{s.value="statusList",u(l).emit("statusList")})}," StatusList ",2)):b("",!0)]),w(e("div",null,[e("div",nt,[e("div",rt,[d(et,{variableList:t.variableList},null,8,["variableList"])]),e("div",ct,[ut,e("div",dt,[d(u(N),{options:u(H).getOption(!0),data:u(C)},null,8,["options","data"])])])]),e("div",pt,[e("div",vt,[_t,e("div",mt,[d(u(N),{options:u(H).getOption(),data:u(_)},null,8,["options","data"])])])])],512),[[k,["MariaDB","MySQL"].includes(t.info.dbType)&&s.value=="dashBoard"]]),w(d(it,null,null,512),[[k,s.value=="processList"]]),w(e("div",null,[d(P,{data:t.variableList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:v()},{default:L(()=>[(o(!0),c(B,null,D(t.variableList.fields,(p,$)=>(o(),x(M,{key:$,prop:p.name,label:p.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[k,t.info.dbType!="SqlServer"&&s.value=="variableList"]]),w(e("div",null,[d(P,{data:t.statusList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:v()},{default:L(()=>[(o(!0),c(B,null,D(t.statusList.fields,(p,$)=>(o(),x(M,{key:$,prop:p.name,label:p.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[k,t.info.dbType!="SqlServer"&&s.value=="statusList"]])])}}});export{Tt as default};
